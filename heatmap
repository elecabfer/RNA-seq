source("http://www.bioconductor.org/biocLite.R")
if (!require("gplots")) {
  install.packages("gplots", dependencies = TRUE)
  library(gplots)
}
if (!require("RColorBrewer")) {
  install.packages("RColorBrewer", dependencies = TRUE)
  library(RColorBrewer)
}
################      HEATMAP
install.packages("gplots", dependencies = TRUE)
install.packages("RColorBrewer", dependencies = TRUE)
library(gplots)
library(RColorBrewer)

###########  
setwd("~/Desktop/RNA/Selene/heatmap/")
data <- read.csv("cgas-wt.csv")
rnames <- data[,1]
mat_data <- data.matrix(data[,2:ncol(data)])
rownames(mat_data) <- rnames

my_palette <- colorRampPalette(c("red", "yellow", "green"))(n = 299)  
col_breaks = c(seq(-6,-1,length=100), # for red
               seq(-1,1,length=100), # for yellow
               seq(1,6,length=100)) # for green
# creates a 5 x 5 inch image
png("~/Desktop/RNA/Selene/heatmap/heatmap_cgas_wt.png")# ,    # create PNG for the heat map        
    #width = 4*300,        # 5 x 300 pixels
    #height = 6098*300,
    #res = 300)            # 300 pixels per inch
    #pointsize = 8)        # smaller font size

heatmap.2(mat_data,
          #cellnote = mat_data,  # same data set for cell labels
          main = "Cgas-WT", # heat map title
          #notecol="black",      # change font color of cell labels to black
          density.info="none",  # turns off density plot inside color legend
          trace="none",         # turns off trace lines inside the heat map
          margins =c(12,9),     # widens margins around plot
          col=my_palette,       # use on color palette defined earlier
          #breaks=col_breaks,    # enable color transition at specified limits
          dendrogram="row",     # only draw a row dendrogram
          Colv="NA")            # turn off column clustering
  
dev.off()               # close the PNG device
  
